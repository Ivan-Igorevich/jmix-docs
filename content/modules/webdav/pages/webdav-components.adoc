= 2. Working with WebDav Components

At this stage of development, the application features a knowledge base management system represented by the `Knowledge base` view.

In this chapter, you will:

* Enhance the webDav document wrapper data grid to display a link to the WebDAV document instead of the document identifier.
* Utilize the xref:webdav:ui-components.adoc#webdav-document-upload-field[webdavDocumentUpload] component on the webDav document wrapper detail view to upload the WebDAV document into the system.

[[add-webdavDocumentUploadField]]
== Adding WebdavDocumentUploadField on View

Locate `webdav-document-wrapper-detail-view.xml` in the *Jmix* tool window and double-click it. The view designer will appear:

image::wdw-detail-view.png[align="center",width="1425"]

You’ll notice that the `entityPicker` component is being used to show the `webdavDocument` attribute.
If you want to display the special component designed to work with documents, you should include the xref:webdav:ui-components.adoc#webdav-document-upload-field[WebdavDocumentUploadField] UI component in the XML descriptor.

Remove the `entityPicker` component description from the XML descriptor and place the cursor after the `departmentField`. Next, click *Add Component* in the actions panel, then find the `WebdavDocumentUploadField` item and double-click it.

image::add-wd-upload-field.png[align="center",width="926"]

The new `webdavDocumentUpload` element will be added beneath the `formLayout` element in both the *Jmix UI* structure panel and in the XML. Configure the `id`, `colspan`, and `property` attributes as shown below.

[source,xml,indent=0]
----
        <formLayout id="form" dataContainer="webdavDocumentWrapperDc">
            <textField id="descriptionField" property="description"
                       colspan="2"/>
            <entityPicker id="departmentField" property="department"
                          colspan="2">
                <actions>
                    <action id="entityLookup" type="entity_lookup"/>
                    <action id="entityClear" type="entity_clear"/>
                </actions>
            </entityPicker>
            <webdav:webdavDocumentUpload id="webdavDocumentField"
                                         property="webdavDocument"
                                         colspan="2"/>
        </formLayout>
----

[[displaying-webdav-document-link]]
== Displaying WebdavDocumentLink in Data Grid

Let's display a link to the document in the data grid instead of its identifier.

Open `webdav-document-wrapper-list-view.xml` and find `webdavDocumentWrappersDataGrid`.

Select the `webdavDocument` column, switch to the *Handlers* tab of the component inspector and create the `renderer` handler method:

[source,java,indent=0]
----
    @Supply(to = "webdavDocumentWrappersDataGrid.webdavDocument", subject = "renderer")
    private Renderer<WebdavDocumentWrapper> webdavDocumentWrappersDataGridWebdavDocumentRenderer() {
        return null;
    }
----

Inject `UiComponents` object into controller class:

[source,java,indent=0]
----
    @Autowired
    private UiComponents uiComponents;
----

TIP: You can use the *Inject* button in the top actions panel of the editor to inject dependencies into view controllers and Spring beans.

Implement the `webdavDocumentWrappersDataGridWebdavDocumentRenderer` method:

[source,java,indent=0]
----
include::example$/webdav-ex1/src/main/java/com/company/onboarding/view/webdavdocumentwrapper/WebdavDocumentWrapperListView.java[tags=webdavDocument-renderer]
----
<1> The method returns a `Renderer` object that creates a UI component to be rendered in the column.
<2> The xref:webdav:ui-components.adoc#webdav-document-link[WebdavDocumentLink] component instance is created using the `UiComponents` factory.

[[running-application]]
== Running the Application

Let’s run the application to observe the new feature in action.

Navigate to `++http://localhost:8080++` using your web browser and sign in to the application with the credentials `admin/admin`.

Choose the `Knowledge base` item from the `Application` menu. You will see the `Webdav document wrappers.list` view.
