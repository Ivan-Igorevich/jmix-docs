= comboBox 下拉列表

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/combobox-simple" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`comboBox` 支持用户从下拉列表中选择单一值。
// It supports filtering of items based on user input.

* XML 元素：`comboBox`

* Java 类：`JmixComboBox`

== 基本用法

满足下列情况可以使用 `comboBox`：

* 用户需要选择单一选项。
* 选项列表应该比较紧凑。如果选项列表对于 xref:flow-ui:vc/components/radioButtonGroup.adoc[radioButtonGroup] 太长时，用下拉列表更方便。
//or SingleSelectList.
// * 用户需要过滤功能。

Jmix Studio 在创建实体详情视图时，会给实体的枚举属性生成 `comboBox` 组件。例如，`User` 实体有 `onboardingStatus` 属性，这是一个 `OnboardingStatus` 枚举类型的属性。

image::visual-components/components/combo-box-basic.png[align="center", width="268"]

在 `comboBox` 元素中，`dataContainer` 属性使用 `userDc` 数据容器，`property` 引用 `onboardingStatus` 实体属性。这里，实体的属性为枚举类型，下拉列表显示所有枚举值的本地化名称。

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/combobox/combo-box-view.xml[tags=data;userDc;layout;basics]
----

[[custom-items]]
== 自定义选项

`comboBox` 的选项列表还可以通过 `setItems()` 方法设置。

首先在 XML 描述中声明组件：

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/combobox/combo-box-view.xml[tags=data;stepDc;layout;custom-options]
----

然后将组件注入控制器，在 `onInit()` 方法中设置选项列表：

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/view/component/combobox/ComboBoxView.java[tags=durationComboBox;onInit;setItems]
----

组件的下拉列表中会显示 `1`、`2`、`3`、`4` 和 `5`。选择的值会设置到 `stepDc` 数据容器中的 `duration` 属性上。

[[validation]]
== 验证

如需检查 `comboBox` 组件输入的值，可以通过内部元素 `validators` 使用 xref:vc/miscellaneous/validator.adoc[validator]。

可使用下列预定义的验证器：

* xref:vc/miscellaneous/validator.adoc#custom-validator[自定义]
* xref:vc/miscellaneous/validator.adoc#DecimalMaxValidator[DecimalMax]
* xref:vc/miscellaneous/validator.adoc#DecimalMinValidator[DecimalMin]
* xref:vc/miscellaneous/validator.adoc#DigitsValidator[Digits]
* xref:vc/miscellaneous/validator.adoc#DoubleMaxValidator[DoubleMax]
* xref:vc/miscellaneous/validator.adoc#DoubleMinValidator[DoubleMin]
* xref:vc/miscellaneous/validator.adoc#EmailValidator[Email]
* xref:vc/miscellaneous/validator.adoc#MaxValidator[Max]
* xref:vc/miscellaneous/validator.adoc#MinValidator[Min]
* xref:vc/miscellaneous/validator.adoc#NegativeOrZeroValidator[NegativeOrZero]
* xref:vc/miscellaneous/validator.adoc#NegativeValidator[Negative]
* xref:vc/miscellaneous/validator.adoc#NotBlankValidator[NotBlank]
* xref:vc/miscellaneous/validator.adoc#NotEmptyValidator[NotEmpty]
* xref:vc/miscellaneous/validator.adoc#NotNullValidator[NotNull]
* xref:vc/miscellaneous/validator.adoc#PositiveOrZeroValidator[PositiveOrZero]
* xref:vc/miscellaneous/validator.adoc#PositiveValidator[Positive]
* xref:vc/miscellaneous/validator.adoc#RegexpValidator[Regexp]
* xref:vc/miscellaneous/validator.adoc#SizeValidator[Size]

== XML 属性

xref:vc/common-attributes.adoc#id[id] -
xref:vc/common-attributes.adoc#alignSelf[alignSelf] -
<<allowCustomValue,allowCustomValue>> -
<<autoOpen,autoOpen>> -
xref:vc/common-attributes.adoc#autofocus[autofocus] -
xref:vc/common-attributes.adoc#classNames[classNames] -
xref:vc/components/textField.adoc#clearButtonVisible[clearButtonVisible] -
xref:vc/common-attributes.adoc#colspan[colspan] -
xref:vc/common-attributes.adoc#dataContainer[dataContainer] -
xref:vc/common-attributes.adoc#enabled[enabled] -
xref:vc/common-attributes.adoc#errorMessage[errorMessage] -
xref:vc/common-attributes.adoc#height[height] -
xref:vc/common-attributes.adoc#helperText[helperText] -
xref:vc/common-attributes.adoc#invalid[invalid] -
<<itemsEnum,itemsEnum>> -
xref:vc/common-attributes.adoc#label[label] -
xref:vc/common-attributes.adoc#maxHeight[maxHeight] -
xref:vc/common-attributes.adoc#maxWidth[maxWidth] -
xref:vc/common-attributes.adoc#minHeight[minHeight] -
xref:vc/common-attributes.adoc#minWidth[minWidth] -
<<pageSize,pageSize>> -
xref:vc/common-attributes.adoc#pattern[pattern] -
xref:vc/common-attributes.adoc#placeholder[placeholder] -
xref:vc/common-attributes.adoc#property[property] -
xref:vc/common-attributes.adoc#readOnly[readOnly] -
xref:vc/common-attributes.adoc#required[required] -
xref:vc/common-attributes.adoc#requiredIndicatorVisible[requiredIndicatorVisible] -
xref:vc/common-attributes.adoc#requiredMessage[requiredMessage] -
xref:vc/common-attributes.adoc#tabIndex[tabIndex] -
xref:vc/common-attributes.adoc#themeNames[themeNames] -
xref:vc/common-attributes.adoc#title[title] -
xref:vc/common-attributes.adoc#visible[visible] -
xref:vc/common-attributes.adoc#width[width]

[[allowCustomValue]]
=== allowCustomValue

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://vaadin.com/docs/latest/components/combo-box/#custom-value-entry" class="vaadin-docs-btn" target="_blank">Vaadin</a>
</div>
++++

如果 `allowCustomValue` 属性为 `true`，用户可以输入不匹配任何选项的字符串值，此时会触发 <<CustomValueSetEvent,CustomValueSetEvent>>。

注意，`comboBox` 不会自动处理自定义字符串。请使用 `CustomValueSetEvent` 进行处理。

默认值为 `false`。

[[autoOpen]]
=== autoOpen

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://vaadin.com/docs/latest/components/combo-box/#auto-open" class="vaadin-docs-btn" target="_blank">Vaadin</a>
</div>
++++

当 `autoOpen` 属性设置为 `true` 时，`comboBox` 的下拉列表会在控件获得焦点（鼠标点击或手指点击）时或用户输入内容时自动展示。

设置为 `false` 禁用该功能。

[[itemsEnum]]
=== itemsEnum

定义枚举类作为控件的选项列表。下拉列表中会显示枚举值的本地化名称；组件的值则为枚举的值。

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/combobox/combo-box-view.xml[tags=itemsEnum]
----

[[pageSize]]
=== pageSize

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://vaadin.com/docs/latest/binding-data/data-provider" class="vaadin-docs-btn" target="_blank">Vaadin</a>
</div>
++++

设置每个请求发送选项的最大数量，值必须大于 0。参考 `com.vaadin.flow.component.combobox.ComboBoxBase.setPageSize()` 方法。

默认分页大小为 `50`。

== 事件和处理器

xref:vc/common-handlers.adoc#AttachEvent[AttachEvent] -
xref:vc/common-handlers.adoc#BlurEvent[BlurEvent] -
xref:vc/common-handlers.adoc#ComponentValueChangeEvent[ComponentValueChangeEvent] -
xref:vc/components/valuePicker.adoc#CustomValueSetEvent[CustomValueSetEvent] -
xref:vc/common-handlers.adoc#DetachEvent[DetachEvent] -
xref:vc/common-handlers.adoc#FocusEvent[FocusEvent] -
<<itemLabelGenerator,itemLabelGenerator>> -
xref:vc/common-handlers.adoc#statusChangeHandler[statusChangeHandler] -
xref:vc/components/textField.adoc#validator[validator]

include::../handler-generation-tip.adoc[]

[[CustomValueSetEvent]]
=== CustomValueSetEvent

当用户输入非空值，且不匹配任何已有选项时，发出 `com.vaadin.flow.component.combobox.ComboBoxBase.CustomValueSetEvent` 事件。如需启用自定义输入，请设置 <<allowCustomValue,allowCustomValue>> 属性为 `true`。

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/combobox/combo-box-view.xml[tags=allowCustomValue]
----

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/view/component/combobox/ComboBoxView.java[tags=colorComboBox;onInit;setColorItems;CustomValueSetEvent]
----

[[itemLabelGenerator]]
=== itemLabelGenerator

`com.vaadin.flow.component.ItemLabelGenerator` 可以自定义某个选项展示给用户的名称。示例：

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/view/component/combobox/ComboBoxView.java[tags=itemLabelGenerator]
----

== XML 内部元素

xref:vc/components/tooltip.adoc[tooltip] -
<<validation,validator>>

== 参考

{vaadin-docs}/components/combo-box[Vaadin 文档^]
