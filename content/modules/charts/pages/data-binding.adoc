= Привязка данных

[[data-provider]]
== DataProvider

Элемент xref:chart-component.adoc#data-set[`dataSet`] принимает реализацию `DataProvider` в качестве источника данных. Экземпляр `DataProvider` передается в метод `withDataProvider()` из элемента `DataSet.Source` компонента графика.

image::data-binding-diagram.png[align="center", width="1318"]

Интерфейс `DataProvider` имеет две стандартные реализации: классы `ListChartItems` и `ContainerChartItems`. Выбор между `ChartDataItems` и `ContainerDataItems` зависит от источника данных.

[[list-data-provider]]
=== ListChartItems

Использование `ListChartItems` позволяет вручную добавлять в график данные, не основанные на сущностях или данные, агрегированные динамически.

Реализация `ListChartItems` содержит коллекцию экземпляров `DataItem`. Интерфейс `DataItem` имеет три реализации:

* `EntityDataItem` оборачивает экземпляр любой сущности для представления данных графика:
+
[source,java,indent=0]
----
include::example$charts-ex1/src/main/java/com/company/demo/view/dataitems/DataItemsView.java[tags=entityDataItems]
----

* `MapDataItem` представляет набор пар ключ-значение в качестве данных графика:
+
[source,java,indent=0]
----
include::example$charts-ex1/src/main/java/com/company/demo/view/dataitems/DataItemsView.java[tags=mapDataItems]
----

* `SimpleDataItem` поддерживает экземпляр любого `public` класса для определения данных графика:
+
[source,java,indent=0]
----
include::example$charts-ex1/src/main/java/com/company/demo/view/dataitems/DataItemsView.java[tags=simpleDataItems]
----

[[container-data-provider]]
=== ContainerDataItems

`ContainerDataItems` используется для назначения xref:flow-ui:data/collection-container.adoc[CollectionContainer] компоненту `Chart`. Этот подход требует существующей сущности, которая будет представлять данные графика.

Предположим, существует data container, который загружает экземпляры `VehicleCount`. Ниже приведен фрагмент XML-дескриптора экрана:
[source,xml,indent=0]
----
include::example$charts-ex1/src/main/resources/com/company/demo/view/vehiclecount/vehicle-count-chart-view.xml[tags=dataCollection]
----

Контроллер экрана определяет метод `onInit()`, который устанавливает data provider для графика. Data provider основан на data container `vehiclesDc`.
[source,java,indent=0]
----
include::example$charts-ex1/src/main/java/com/company/demo/view/vehiclecount/VehicleCountChartView.java[tags=dataSet]
----

Чтобы привязать данные декларативно, используйте элемент xref:chart-component.adoc#data-set[`dataSet`] в файле XML-дескриптора вашего экрана и установить определенный `dataContainer` в качестве источника данных.
[source,xml,indent=0]
----
include::example$charts-ex1/src/main/resources/com/company/demo/view/vehiclecount/vehicle-count-chart-view.xml[tags=dataSet]
----

[[gauge-series-data-binding]]
== Привязка данных для GaugeSeries

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/gauge-series-simple" class="live-demo-btn" target="_blank">LIVE DEMO</a>
</div>
++++

В отличие от других типов графиков, `gaugeSeries` не поддерживают `DataSet`.

Чтобы добавить данные в график `gaugeSeries` декларативно, определите элемент `dataItem` внутри `series.data` компонента графика в XML-дескрипторе графика следующим образом:

[source,xml,indent=0]
----
include::example$charts-ex1/src/main/resources/com/company/demo/view/gauge/gauge-series-view.xml[tags=dataBinding]
----

Или получите атрибут `series` в контроллере экрана и используйте метод `setData()` для программной привязки данных.

[source,java,indent=0]
----
include::example$charts-ex1/src/main/java/com/company/demo/view/gauge/GaugeSeriesView.java[tags=dataBinding]
----

NOTE: Объект `DataItem`, используемый для привязки данных к графику `gaugeSeries`, отличается от `DataItem`, упомянутого в других контекстах привязки данных графиков.