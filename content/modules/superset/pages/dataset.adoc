= Dataset

In this section, you will:

* Create a database connection
* Create a dataset

[[database-connection]]
== Create a database connection

When Superset is started we need to create a connection to the database where we store a data for dashboards. In previous steps when we configured Superset containers, we created the `jmix_database` service which starts the `PostgreSQL` in `docker-compose-non-dev.yml` file. This database is used in our Jmix project, and now we configure the database connection from Superset.

In Superset settings click on *Database connections* item:

image::settings-databsase-connections.png[align="center", width="204"]

Create new database connection. In the opened dialog select `PostgreSQL` type and enter connection details:

image::new-database-connection.png[align="center", width="498"]

Click to *CONNECT* button and then to *FINISH* button. Now the connection to the `jmix_database` service is created.

[[dataset]]
== Create a dataset

In Apache Superset, a dataset refers to a collection of data that can be used for creating charts. It can be either a physical dataset, which represents a table or view in a database, or a virtual dataset, which is a query that can be saved and reused as a dataset.

In our Onboarding database `User` table has the foreign key to `Department`. To visualize users data by departments we have to use the last option -  a query that will be reused as a dataset.

In top menu navigate to *SQL* and select the *SQL Lab*. In the opened screen fill the fields:

* *DATABASE*: `Jmix Onboarding`
* *SCHEMA*: `public`

Now we should write a query that will be used as a dataset. Since we should create a dashboard to visualize employee' salaries including employee' department we need to select the following columns:

- user's full name
- department
- salary

So the result query will be the following:

[source, SQL]
----
SELECT CONCAT(first_name, ' ', last_name) as fullName, dpr.name as departmentName, usr.salary
FROM public.user_ AS usr
INNER join department AS dpr on usr.department_id = dpr.id
----

We use `INNER JOIN` here to avoid users without department (`admin` user). If you run this query you will see the following result:

image::sql-lab.png[align="center"]

Let's save the query and call it *Employees' salaries*.