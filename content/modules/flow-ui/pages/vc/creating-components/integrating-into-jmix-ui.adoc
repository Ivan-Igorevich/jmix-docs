= 与 Jmix UI 集成

在创建了组件的客户端和服务端之后，便可以在 xref:views/views.adoc[视图] 中使用，只需创建组件的 Java 类实例并添加至父组件即可。

但是，视图的内容一般在 XML 文件中定义。本节介绍如何在 XML 中使用新创建的组件以及如何在 Studio 的可视化设计器中与其他 Jmix UI 组件一样使用。

[[support-in-xml-descriptors]]
== 支持 XML

以下是为 xref:vc/creating-components/js-component.adoc[前一章] 创建的 Slider 组件实现 XML 支持的示例。

. 创建 `app-ui-components.xsd` 文件并定义组件的 XML 标记：
+
[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/app-ui-components.xsd[tags=xsd-schema;!theme-toggle-schema]
----

. 创建一个组件加载器，当在视图 XML 中使用组件时，需要用加载器初始化该组件。
+
[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/component/SliderLoader.java[tags=slider-loader]
----
<1> 基类提供了辅助方法用于加载属性值。
<2> `componentLoader()` 方法返回 `ComponentLoaderSupport` bean 的实例，提供了加载通用属性的方法。

. 为了在框架中注册组件和加载器，需要创建一个 Spring 配置类，并使用 `@Configuration` 注解：
+
[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/ComponentRegistrationConfiguration.java[tags=component-registration-configuration;!theme-toggle-registration]
----

然后，可以在视图的 XML 中定义 `Slider` 组件了：

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/customcomponent/jscomponent/js-component-view.xml[tags=slider-xml]
----
<1> 用与组件 XSD 中相同的 `xmlns` 和 `targetNamespace` 属性定义命名空间。
<2> 添加 `slider` 元素时，需使用命名空间前缀。

[[studio-support]]
== 支持 Studio

在 Studio 中支持新组件，需要创建一个带 `@StudioUiKit` 注解的接口，其中包含一个带 `@StudioComponent` 注解的方法：

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/component/StudioComponents.java[tags=studio-components]
----

然后，Studio 会在 *Add Component* 工具箱中显示新的组件了：

image::visual-components/creating-components/add-component-menu.png[align="center", width="395"]

以及在组件的属性面板中显示其可用的属性：

image::visual-components/creating-components/studio-support.png[align="center", width="428"]

